<div 
  id="modal-overlay"
  class="fixed inset-0 bg-black/40 flex items-center justify-center p-4"
  onclick="if(event.target.id==='modal-overlay'){ document.getElementById('modal-slot').innerHTML=''; }"
>
  <div class="bg-white rounded-2xl w-full max-w-md p-6 shadow-xl">
    <div class="flex items-start justify-between mb-4">
      <h3 class="text-lg font-semibold">
        Confirmar agendamento — {{ selected_date|date:"d/m/Y" }} às {{ time_option.horario|time:"H:i" }}
      </h3>
      <button 
        type="button"
        class="text-slate-500 hover:text-slate-700"
        onclick="document.getElementById('modal-slot').innerHTML='';"
      >
        ✕
      </button>
    </div>

  <form
    hx-post="{% url 'core:book' %}"
    hx-target="#modal-slot"
    hx-swap="innerHTML"
    class="space-y-3"
  >
    {% csrf_token %}
    <input type="hidden" name="booking_date" value="{{ selected_date|date:'Y-m-d' }}">
    <input type="hidden" name="time_id" value="{{ time_option.id }}">

    <div>
      <label class="block text-sm mb-1">Nome</label>
      <input name="client_name" required class="w-full rounded-lg border px-3 py-2">
    </div>

    <div>
      <label class="block text-sm mb-1">Telefone</label>
      <input 
        type="tel" 
        name="client_phone" 
        required 
        placeholder="(00) 00000-0000" 
        class="w-full rounded-lg border px-3 py-2"
        title="Digite no formato (00) 00000-0000 ou (00) 0000-0000"
        pattern="\(\d{2}\)\s?\d{4,5}-\d{4}" 
      >
    </div>

    <div>
      <label class="block text-sm mb-1">Observação</label>
      <input name="observation" class="w-full rounded-lg border px-3 py-2">
    </div>

    <div>
      <label class="block text-sm mb-1">Serviço</label>
      <select name="service_id" required class="w-full rounded-lg border px-3 py-2">
        <option value="" selected disabled>Selecione...</option>
        {% for s in services %}
          <option value="{{ s.id }}">{{ s.name }} - R$: {{ s.price_brl }}</option>
        {% empty %}
          <option disabled>Nenhum serviço ativo — cadastre no painel do manager.</option>
        {% endfor %}
      </select>
    </div>

    <button class="w-full rounded-lg bg-blue-600 text-white py-2 hover:bg-blue-700 transition">
      Confirmar
    </button>
  </form>

  </div>
</div>
